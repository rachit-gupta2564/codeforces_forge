<h3><a href="https://codeforces.com/contest/2202/problem/E" target="_blank" rel="noopener noreferrer">Rigged Bracket Sequence</a></h3>

<div class="header"><div class="title">E. Rigged Bracket Sequence</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p> </p><p>A regular bracket sequence is a sequence consisting of '<span class="tex-font-style-tt">(</span>' and '<span class="tex-font-style-tt">)</span>', which can be turned into a valid math expression by inserting $$$1$$$ and $$$+$$$ any number of times into the sequence. For example, the sequence "<span class="tex-font-style-tt">()(()())</span>" is a regular bracket sequence, while "<span class="tex-font-style-tt">())(()</span>" or "<span class="tex-font-style-tt">(()</span>" are not regular bracket sequences.</p><p>You are given a regular bracket sequence $$$S$$$.</p><p>Let us consider shifting a <span class="tex-font-style-bf">subsequence</span>$$$^{\text{∗}}$$$ to the right. Formally, when a subsequence $$$S_{i_1} S_{i_2} \ldots S_{i_k}$$$ is shifted to the right, the characters on the chosen indices <span class="tex-font-style-bf">simultaneously</span> get reassigned as follows:</p><ul> <li> $$$S_{i_1} \leftarrow S_{i_k}$$$; </li><li> $$$S_{i_2} \leftarrow S_{i_1}$$$; </li><li> $$$S_{i_3} \leftarrow S_{i_2}$$$; </li><li> $$$\ldots$$$ </li><li> $$$S_{i_k} \leftarrow S_{i_{k-1}}$$$. </li></ul><p>In other words, the element of the $$$j$$$-th chosen index gets reassigned to the $$$((j-2) \bmod k + 1)$$$-th chosen character.</p><p>For example, when $$$S$$$ is "<span class="tex-font-style-tt">()(()())</span>", shifting the subsequence $$$S_2 S_4$$$ changes $$$S$$$ to "<span class="tex-font-style-tt">(<span class="tex-font-style-bf">(</span>(<span class="tex-font-style-bf">)</span>)())</span>". On the other hand, shifting $$$S_2 S_3 S_5$$$ changes $$$S$$$ to "<span class="tex-font-style-tt">(<span class="tex-font-style-bf">))</span>(<span class="tex-font-style-bf">(</span>())</span>".</p><p>Please count how many <span class="tex-font-style-bf">non-empty subsequences</span> make $$$S$$$ remain regular when shifted to the right. As the answer may be huge, you are only asked to output the answer modulo $$$998\,244\,353$$$.</p><div class="statement-footnote"><p>$$$^{\text{∗}}$$$A sequence $$$a$$$ is a subsequence of a sequence $$$b$$$ if $$$a$$$ can be obtained from $$$b$$$ by the deletion of several (possibly, zero or all) element from arbitrary positions. Two subsequences are considered different if the sets of <span class="tex-font-style-bf">positions</span> of the deleted elements are different. </p></div></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 10^4$$$). The description of the test cases follows. </p><p>The first line of each test case contains a single integer $$$n$$$ ($$$2 \le n \le 300\,000$$$, $$$n$$$ <span class="tex-font-style-bf">is even</span>).</p><p>The second line of each test case contains a <span class="tex-font-style-bf">regular</span> bracket sequence $$$S$$$ of length $$$n$$$ given as a string without spaces.</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$300\,000$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, output the answer modulo $$$998\,244\,353$$$ on a separate line.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id000326114236887558" id="id00016924152763666434" class="input-output-copier">Copy</div></div><pre id="id000326114236887558"><div class="test-example-line test-example-line-even test-example-line-0">4</div><div class="test-example-line test-example-line-odd test-example-line-1">2</div><div class="test-example-line test-example-line-odd test-example-line-1">()</div><div class="test-example-line test-example-line-even test-example-line-2">4</div><div class="test-example-line test-example-line-even test-example-line-2">()()</div><div class="test-example-line test-example-line-odd test-example-line-3">6</div><div class="test-example-line test-example-line-odd test-example-line-3">(()())</div><div class="test-example-line test-example-line-even test-example-line-4">10</div><div class="test-example-line test-example-line-even test-example-line-4">()((())())</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id0023525282752028454" id="id0014229524719667952" class="input-output-copier">Copy</div></div><pre id="id0023525282752028454"><div class="test-example-line test-example-line-odd test-example-line-1">2</div><div class="test-example-line test-example-line-even test-example-line-2">8</div><div class="test-example-line test-example-line-odd test-example-line-3">28</div><div class="test-example-line test-example-line-even test-example-line-4">312</div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the second test case, the $$$8$$$ non-empty subsequences that make $$$S$$$ remain regular when shifted to the right are as follows:</p><ul> <li> $$$S_1$$$: changes $$$S$$$ to "<span class="tex-font-style-tt"><span class="tex-font-style-bf">(</span>)()</span>"; </li><li> $$$S_2$$$: changes $$$S$$$ to "<span class="tex-font-style-tt">(<span class="tex-font-style-bf">)</span>()</span>"; </li><li> $$$S_3$$$: changes $$$S$$$ to "<span class="tex-font-style-tt">()<span class="tex-font-style-bf">(</span>)</span>"; </li><li> $$$S_4$$$: changes $$$S$$$ to "<span class="tex-font-style-tt">()(<span class="tex-font-style-bf">)</span></span>"; </li><li> $$$S_1 S_3$$$: changes $$$S$$$ to "<span class="tex-font-style-tt"><span class="tex-font-style-bf">(</span>)<span class="tex-font-style-bf">(</span>)</span>"; </li><li> $$$S_2 S_3$$$: changes $$$S$$$ to "<span class="tex-font-style-tt">(<span class="tex-font-style-bf">()</span>)</span>"; </li><li> $$$S_2 S_4$$$: changes $$$S$$$ to "<span class="tex-font-style-tt">(<span class="tex-font-style-bf">)</span>(<span class="tex-font-style-bf">)</span></span>"; </li><li> $$$S_1 S_2 S_3$$$: changes $$$S$$$ to "<span class="tex-font-style-tt"><span class="tex-font-style-bf">(()</span>)</span>". </li></ul></div>