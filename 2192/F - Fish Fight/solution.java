import java.io.*;import java.util.*; public class Main {    static final long MOD = 1000000007L;    static final long INV = 500000004L;    static final int N = 3000;    static final int SIZE = N + 6;     static int T;    static int n, x, y;     static long[] a = new long[SIZE];    static long[] b = new long[SIZE];    static long[] sum = new long[SIZE];     static int[] f = new int[SIZE * SIZE];    static int[] g = new int[SIZE * SIZE];    static int[] h0 = new int[SIZE * SIZE];    static int[] h1 = new int[SIZE * SIZE];     static int idx(int i, int j) {        return i * SIZE + j;    }     static void reverse(long[] arr, int l, int r) {        while (l < r) {            long tmp = arr[l];            arr[l] = arr[r];            arr[r] = tmp;            l++;            r--;        }    }     static void clearTable(int[] tab, int n) {        for (int i = 1; i <= n; i++) {            int base = i * SIZE;            Arrays.fill(tab, base + 1, base + n + 1, 0);        }    }     static long solve(FastScanner fs) throws Exception {        n = (int) fs.nextLong();        x = (int) fs.nextLong();        y = (int) fs.nextLong();         for (int i = 1; i <= n; i++) a[i] = fs.nextLong();        for (int i = 1; i <= n; i++) b[i] = fs.nextLong();         if (x > y) {            x = n - x + 1;            y = n - y + 1;            reverse(a, 1, n);            reverse(b, 1, n);        }         sum[0] = 0;        for (int i = 1; i <= n; i++) sum[i] = sum[i - 1] + b[i];         long ans = 0;        int L = 0, R = 0, mx = 0;         f[idx(x, x)] = 1;        g[idx(y, y)] = 1;        if (x + 1 == y) h0[idx(x, x)] = 1;         for (int len = 1; len < n; len++) {            for (int r = len; r <= n; r++) {                int l = r - len + 1;                if (l <= x && x <= r) {                    int judl = 0, judr = 0;                    long jud = 1;                    long seg = sum[r] - sum[l - 1] + a[x] - b[x];                    if (1 < l && seg >= a[l - 1]) judl = 1;                    if (r < n && seg >= a[r + 1]) judr = 1;                    if (judl == 1 && judr == 1) jud = INV;                     int cur = f[idx(l, r)];                    if (cur != 0) {                        if (judl == 1) {                            int dest = idx(l - 1, r);                            long add = (long) cur * jud % MOD;                            f[dest] = (int) ((f[dest] + add) % MOD);                        }                        if (judr == 1) {                            int dest = idx(l, r + 1);                            long add = (long) cur * jud % MOD;                            f[dest] = (int) ((f[dest] + add) % MOD);                             int rp = r + 1 + len;                            if (y <= rp && rp <= n) {                                int gval = g[idx(r + 2, rp)];                                if (gval != 0) {                                    int hd = idx(l, r + 1);                                    long addh = (long) cur * jud % MOD;                                    addh = addh * gval % MOD;                                    h1[hd] = (int) ((h1[hd] + addh) % MOD);                                }                            }                        }                    }                }            }             for (int r = len; r <= n; r++) {                int l = r - len + 1;                if (l <= y && y <= r && 1 < l) {                    int curG = g[idx(l, r)];                    if (len > mx && curG != 0) {                        mx = len;                        L = l;                        R = r;                    }                     int judl = 0, judr = 0;                    long jud = 1;                    long seg = sum[r] - sum[l - 1] + a[y] - b[y];                    if (1 < l && seg >= a[l - 1]) judl = 1;                    if (r < n && seg >= a[r + 1]) judr = 1;                    if (judl == 1 && judr == 1) jud = INV;                     if (curG != 0) {                        if (judl == 1) {                            int dest = idx(l - 1, r);                            long add = (long) curG * jud % MOD;                            g[dest] = (int) ((g[dest] + add) % MOD);                             int lp = l - 1 - len - 1;                            if (1 <= lp && lp <= x) {                                int fval = f[idx(lp, l - 2)];                                if (fval != 0) {                                    int hd = idx(lp, l - 2);                                    long addh = (long) curG * jud % MOD;                                    addh = addh * fval % MOD;                                    h0[hd] = (int) ((h0[hd] + addh) % MOD);                                }                            }                        }                        if (judr == 1) {                            int dest = idx(l, r + 1);                            long add = (long) curG * jud % MOD;                            g[dest] = (int) ((g[dest] + add) % MOD);                        }                    }                }            }        }         for (int len = 1; len < n; len++) {            for (int r = len; r <= n; r++) {                int l = r - len + 1;                int rr = r + len - 1;                if (rr <= n && l <= x && x <= r && r + 1 <= y && y <= rr) {                    long suml = sum[r] - sum[l - 1] + a[x] - b[x];                    long sumr = sum[rr] - sum[r] + a[y] - b[y];                     int judl = 0, judr = 0;                    long jud = 1;                    if (suml <= sumr) judl = 1;                    if (r + len <= n && sumr >= a[r + len]) judr = 1;                    if (judl == 1 && judr == 1) jud = INV;                     int id = idx(l, r);                    int curH1 = h1[id];                    if (curH1 != 0) {                        if (judr == 1) {                            long add = (long) curH1 * jud % MOD;                            h0[id] = (int) ((h0[id] + add) % MOD);                        }                        if (judl == 0 && judr == 0) {                            ans = (ans + curH1) % MOD;                        }                    }                }            }             for (int r = len; r <= n; r++) {                int l = r - len + 1;                int rr = r + len;                if (rr <= n && l <= x && x <= r && r + 1 <= y && y <= rr) {                    long suml = sum[r] - sum[l - 1] + a[x] - b[x];                    long sumr = sum[rr] - sum[r] + a[y] - b[y];                     int judl = 0, judr = 0;                    long jud = 1;                    if (1 < l && a[l - 1] <= suml) judl = 1;                    if (suml >= sumr) judr = 1;                    if (judl == 1 && judr == 1) jud = INV;                     int id = idx(l, r);                    int curH0 = h0[id];                    if (curH0 != 0) {                        if (judl == 1) {                            int dest = idx(l - 1, r);                            long add = (long) curH0 * jud % MOD;                            h1[dest] = (int) ((h1[dest] + add) % MOD);                        }                        if (judr == 1) {                            long add = (long) curH0 * jud % MOD;                            ans = (ans + add) % MOD;                        }                    }                }            }        }         for (int r = x; r < y; r++) {            for (int l = x; l >= 1; l--) {                int len = r - l + 1;                if (len == mx + 1 && r < L - 1) {                    int fv = f[idx(l, r)];                    int gv = g[idx(L, R)];                    if (fv != 0 && gv != 0) {                        ans = (ans + (long) fv * gv) % MOD;                    }                }            }        }         clearTable(f, n);        clearTable(g, n);        clearTable(h0, n);        clearTable(h1, n);         return ans;    }     public static void main(String[] args) throws Exception {        FastScanner fs = new FastScanner(System.in);        StringBuilder sb = new StringBuilder();        T = (int) fs.nextLong();        while (T-- > 0) {            sb.append(solve(fs)).append('\n');        }        System.out.print(sb.toString());    }     static class FastScanner {        private final InputStream in;        private final byte[] buffer = new byte[1 << 16];        private int ptr = 0, len = 0;         FastScanner(InputStream is) {            in = is;        }         private int read() throws IOException {            if (ptr >= len) {                len = in.read(buffer);                ptr = 0;                if (len <= 0) return -1;            }            return buffer[ptr++];        }         long nextLong() throws IOException {            int c;            do {                c = read();                if (c == -1) return Long.MIN_VALUE;            } while (c <= ' ');             long sgn = 1;            if (c == '-') {                sgn = -1;                c = read();            }             long val = 0;            while (c > ' ') {                val = val * 10 + (c - '0');                c = read();            }            return val * sgn;        }    }}