import java.util.*;public class Main {    static long ceilDiv(long a, long b) {        return (a + b - 1) / b;    }    static boolean can(long T, int n, long h, long k, long sum, long[] bestPref) {        long q = 0;        int y = 0;         if (T <= 0) return false;         if (T <= n) {            y = (int) T;        } else {            T -= n;            q = 1;             long cycle = k + (long) n;            long full = T / cycle;            q += full;            long rem = T % cycle;             if (rem > k) {                long shots = rem - k;                if (shots > n) shots = n;                y = (int) shots;            }        }         long dmg = q * sum + bestPref[y];        return dmg >= h;    }    public static void main(String[] args) {        Scanner fs = new Scanner(System.in);        int t = (int) fs.nextLong();        StringBuilder out = new StringBuilder();         while (t-- > 0) {            int n = (int) fs.nextLong();            long h = fs.nextLong();            long k = fs.nextLong();             long[] a = new long[n + 1];            for (int i = 1; i <= n; i++) a[i] = fs.nextLong();             long[] pref = new long[n + 1];            for (int i = 1; i <= n; i++) pref[i] = pref[i - 1] + a[i];            long sum = pref[n];             long[] minPref = new long[n + 1];            minPref[1] = a[1];            for (int i = 2; i <= n; i++) minPref[i] = Math.min(minPref[i - 1], a[i]);             long[] sufMax = new long[n + 2];            sufMax[n] = a[n];            for (int i = n - 1; i >= 1; i--) sufMax[i] = Math.max(a[i], sufMax[i + 1]);             long[] bestPref = new long[n + 1];            bestPref[0] = 0;            for (int y = 1; y <= n; y++) {                long v = pref[y];                if (y < n) {                    long delta = sufMax[y + 1] - minPref[y];                    if (delta > 0) v += delta;                }                bestPref[y] = v;            }             long m = ceilDiv(h, sum);            long hi = m * ((long) n + k) + n;            long lo = 1;             while (lo < hi) {                long mid = (lo + hi) >>> 1;                if (can(mid, n, h, k, sum, bestPref)) hi = mid;                else lo = mid + 1;            }             out.append(lo).append('\n');        }         System.out.print(out.toString());    }}