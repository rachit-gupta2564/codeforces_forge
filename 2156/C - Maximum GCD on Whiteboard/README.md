<h3><a href="https://codeforces.com/contest/2156/problem/C" target="_blank" rel="noopener noreferrer">Maximum GCD on Whiteboard</a></h3>

<div class="header"><div class="title">C. Maximum GCD on Whiteboard</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p> </p><p>You are given an integer $$$k$$$ and $$$n$$$ positive integers $$$a_1, a_2, \ldots, a_n$$$ written on a whiteboard, where $$$1\le a_i\le \boldsymbol{n}$$$. You may perform the following operations:</p><ul> <li> <span class="tex-font-style-bf">Erase</span>: Choose an integer from the whiteboard and erase it. This operation can be performed at most $$$k$$$ times. </li><li> <span class="tex-font-style-bf">Split</span>: Choose an integer $$$x\ge 3$$$ from the whiteboard. Split it into three positive integers $$$x_1$$$, $$$x_2$$$, and $$$x_3$$$ such that $$$x_1 + x_2 + x_3 = x$$$, and $$$1\le x_1\le x_2\le x_3$$$. Then, erase $$$x$$$ from the whiteboard and write two new integers $$$x_1$$$ and $$$x_3$$$ on the whiteboard. Note that $$$x_2$$$ is <span class="tex-font-style-bf">discarded</span> and <span class="tex-font-style-bf">not</span> written on the whiteboard. This operation may be performed any number of times. </li></ul><p>The <span class="tex-font-style-it">beauty</span> of a collection of integers $$$b$$$ is defined as the greatest common divisor of all the elements in $$$b$$$. Formally, it is the largest integer $$$d$$$ such that $$$d$$$ divides $$$x$$$ for every $$$x$$$ that is an element of $$$b$$$.</p><p>Your task is to determine the maximum possible beauty of the integers on the whiteboard after performing at most $$$k$$$ <span class="tex-font-style-bf">Erase</span> operations and any number of <span class="tex-font-style-bf">Split</span> operations.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 10^4$$$). The description of the test cases follows. </p><p>The first line of each test case contains two integers $$$n$$$ and $$$k$$$ ($$$1\le n \le 2 \cdot 10^5$$$, $$$0 \le k \le n - 1$$$) — the number of integers on the whiteboard, and the maximum number of <span class="tex-font-style-bf">Erase</span> operations allowed.</p><p>The second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \ldots, a_n$$$ ($$$1 \le a_i \le \boldsymbol{n}$$$) — the integers initially written on the whiteboard.</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2 \cdot 10^5$$$. </p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, output a single integer representing the maximum beauty of the elements written on the whiteboard after performing the operations.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id003968868684398358" id="id005199810723344395" class="input-output-copier">Copy</div></div><pre id="id003968868684398358"><div class="test-example-line test-example-line-even test-example-line-0">6</div><div class="test-example-line test-example-line-odd test-example-line-1">9 1</div><div class="test-example-line test-example-line-odd test-example-line-1">4 9 6 8 2 6 7 8 2</div><div class="test-example-line test-example-line-even test-example-line-2">10 1</div><div class="test-example-line test-example-line-even test-example-line-2">4 9 6 8 2 6 7 8 2 7</div><div class="test-example-line test-example-line-odd test-example-line-3">7 5</div><div class="test-example-line test-example-line-odd test-example-line-3">1 1 2 3 4 5 5</div><div class="test-example-line test-example-line-even test-example-line-4">7 4</div><div class="test-example-line test-example-line-even test-example-line-4">1 1 2 3 4 5 5</div><div class="test-example-line test-example-line-odd test-example-line-5">14 3</div><div class="test-example-line test-example-line-odd test-example-line-5">14 12 7 12 9 9 12 4 3 1 3 6 9 13</div><div class="test-example-line test-example-line-even test-example-line-6">1 0</div><div class="test-example-line test-example-line-even test-example-line-6">1</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id009492421241136684" id="id00625060896445948" class="input-output-copier">Copy</div></div><pre id="id009492421241136684"><div class="test-example-line test-example-line-odd test-example-line-1">2</div><div class="test-example-line test-example-line-even test-example-line-2">1</div><div class="test-example-line test-example-line-odd test-example-line-3">5</div><div class="test-example-line test-example-line-even test-example-line-4">1</div><div class="test-example-line test-example-line-odd test-example-line-5">3</div><div class="test-example-line test-example-line-even test-example-line-6">1</div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test case, you may perform the following sequence of operations:</p><ul> <li> <span class="tex-font-style-bf">Erase</span> $$$7$$$. The whiteboard now contains the integers $$$[4,9,6,8,2,6,8,2]$$$. </li><li> <span class="tex-font-style-bf">Split</span> $$$9$$$ into three integers $$$2$$$, $$$3$$$, and $$$4$$$. $$$9$$$ is erased from the whiteboard, and two new integers $$$2$$$ and $$$4$$$ are written. The whiteboard now contains the integers $$$[4,\underline{2,4},6,8,2,6,8,2]$$$. </li><li> <span class="tex-font-style-bf">Split</span> $$$8$$$ into three integers $$$2$$$, $$$2$$$, and $$$4$$$. $$$8$$$ is erased from the whiteboard, and two new integers $$$2$$$ and $$$4$$$ are written. The whiteboard now contains the integers $$$[4,2,4,6,\underline{2,4},2,6,8,2]$$$ (It does not matter which $$$8$$$ <span class="tex-font-style-bf">Split</span> is performed on as the ordering in the array does not matter). </li></ul><p>The beauty of the integers on the whiteboard after the operations is $$$2$$$ as it is the largest number that divides all the integers on the whiteboard ($$$2$$$, $$$4$$$, $$$6$$$, and $$$8$$$). Note that the last operation is unnecessary — the beauty of the integers on the whiteboard after the second operation is already $$$2$$$.</p><p>In the second test case, note that the <span class="tex-font-style-bf">Erase</span> operation can only remove one occurrence of an integer, even if duplicates exist. Here, we are only able to erase one copy of $$$7$$$, so there will still be one remaining $$$7$$$ on the whiteboard. Hence, we are unable to perform the same sequence of operations as in the first test case.</p><p>In the third test case, we can erase integers $$$1$$$, $$$1$$$, $$$2$$$, $$$3$$$, and $$$4$$$, leaving only $$$[5, 5]$$$ on the whiteboard. Since both numbers are $$$5$$$, their greatest common divisor is $$$5$$$, and the maximum beauty is $$$5$$$.</p></div>