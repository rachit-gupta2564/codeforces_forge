import java.io.*;import java.util.*;public class NonDescendingA{    static final long MOD=998244353L;    public static void main(String[] args) throws Exception{        BufferedReader br=new BufferedReader(new InputStreamReader(System.in));        int t=Integer.parseInt(br.readLine().trim());        StringBuilder sb=new StringBuilder();        while(t-->0){            int n=Integer.parseInt(br.readLine().trim());            int[] a=new int[n+1];            int[] b=new int[n+1];            StringTokenizer st=new StringTokenizer(br.readLine());            for(int i=1;i<=n;i++) a[i]=Integer.parseInt(st.nextToken());            st=new StringTokenizer(br.readLine());            for(int i=1;i<=n;i++) b[i]=Integer.parseInt(st.nextToken());            int[] x=new int[n+1];            int[] y=new int[n+1];            for(int i=1;i<=n;i++){                if(a[i]<=b[i]){ x[i]=a[i]; y[i]=b[i]; } else { x[i]=b[i]; y[i]=a[i]; }            }            long dp0=1, dp1=1;            for(int i=2;i<=n;i++){                long nd0=0, nd1=0;                if(x[i-1]<=x[i] && y[i-1]<=y[i]) nd0=(nd0+dp0)%MOD;                if(y[i-1]<=x[i] && x[i-1]<=y[i]) nd0=(nd0+dp1)%MOD;                if(x[i-1]<=y[i] && y[i-1]<=x[i]) nd1=(nd1+dp0)%MOD;                if(y[i-1]<=y[i] && x[i-1]<=x[i]) nd1=(nd1+dp1)%MOD;                dp0=nd0; dp1=nd1;            }            sb.append((dp0+dp1)%MOD).append('\n');        }        System.out.print(sb.toString());    }}